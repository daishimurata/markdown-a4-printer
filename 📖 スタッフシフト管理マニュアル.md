---
tags:
  - manual
  - shift
  - staff
title: スタッフシフト管理マニュアル
created: 2025-06-10
---

# 📖 スタッフシフト管理マニュアル

## 🎯 概要

このシステムは **Node.js + Templater + QuickAdd** を使用して、一括でスタッフのシフト枠を30日分自動生成し、Database Folderビューでクリック編集できる仕組みです。

---

## 🔹 1か月先までのシフト更新手順

### ステップ1: 一括シフト枠生成

**新しい月が近づいたら**  
`Ctrl+Alt+S` **（Run for Staff シフト生成）** を1回実行  

→ 全スタッフ分のYAMLに翌30日分の "A" が下書きされます

### ステップ2: シフト編集

**Staff フォルダを Database Folder ビューで開き**  
日付列のセルをクリック → `A/B/C` を選択  

- **A** = 早番（09:00-17:00）
- **B** = 遅番（13:00-21:00） 
- **C** = 休み

### ステップ3: 例外時間の設定

その他の時間帯が必要な場合は、セルに直接時刻を入力
例: `"09:00-15:00"`, `"10:00-18:00"`

### ステップ4: 確認

**日報テンプレ** を開くと  
"今日のスタッフ" 欄に自動反映されます

---

## 🔹 QuickAdd設定手順

### 新規設定の場合

1. **QuickAdd → Macros → New Macro → "Run for Staff シフト生成"**
2. **Macro type**: *Run Shell*
3. **Command**:
   ```bash
   node scripts/add_month_shifts.js
   ```
4. **Hotkey** → `Ctrl+Alt+S` を設定

---

## 🔹 Database Folder ビュー設定

### 初回設定

1. **Staff フォルダを開く**
2. **コマンドパレット** → `Database: Convert current folder to DB`

### カラム設定

- `default_shift`: **Text** 型
- `shift`: **LongText** 型（非表示列推奨）
- 各日付列（`2025-06-10` など）: **Select** 型
  - プルダウン選択肢: `A,B,C`

### 編集方法

- 表のセルをクリック → A/B/C を選択するだけでYAMLが自動更新
- 例外時間は `"10:00-18:00"` のように直接入力

---

## 🔹 システム構成

### ファイル構成
```
ohisamafarm/
├── scripts/
│   └── add_month_shifts.js     # シフト生成スクリプト
├── Staff/                      # スタッフ個人ファイル
│   ├── 村田太志.md
│   ├── 松本愛美.md
│   └── ...
└── .templates/
    └── daily_report.md         # 日報テンプレート（連携済み）
```

### YAML構造
```yaml
---
default_shift: "09:00-17:00"    # デフォルト時間帯
shift:                          # シフト配列
  - "2025-06-10 A"             # A=早番
  - "2025-06-11 B"             # B=遅番
  - "2025-06-12 C"             # C=休み
  - "2025-06-13 09:00-15:00"   # 例外時間
---
```

---

## 🔹 トラブルシューティング

### Q: スクリプトが動かない
**A**: `npm i gray-matter` でライブラリがインストールされているか確認

### Q: 日報に反映されない
**A**: Templater/DataviewJSプラグインが有効か確認

### Q: Database Folderが表示されない
**A**: Database Folderプラグインが有効化されているか確認

### Q: 既存のシフトが上書きされる
**A**: スクリプトは既存日付をスキップします。安全に実行可能

---

## 🔹 運用のポイント

### 月次作業
- 月末近くに一度 `Ctrl+Alt+S` で翌月分を生成
- Database Folderビューで一括編集

### 日次作業
- 急な変更は個別にセルを編集
- 日報確認時に自動反映をチェック

### スタッフ追加時
- 新しいスタッフファイル作成後
- `Ctrl+Alt+S` で自動的にシフト枠が生成される

---

## 📝 更新履歴

- **2025-06-10**: システム導入・マニュアル作成 